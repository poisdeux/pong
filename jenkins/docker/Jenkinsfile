def newApp
node {
  checkout scm
  stage('Building test image') {
    newApp = docker.build("poisdeux/pong:latest-test", "jenkins/test")
  }
  stage('Test image') {
    // run some tests on it (see below), then if everything looks good:
  }
  stage('Push image') {
    newApp.push()
  }
}
